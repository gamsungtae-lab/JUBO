<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë³´ ì¢…í•© ìƒí™©íŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { font-family: 'Pretendard', sans-serif; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.1); }
    </style>
</head>
<body class="bg-slate-100 min-h-screen p-4 md:p-8">

    <div class="max-w-6xl mx-auto">
        <header class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4 bg-white p-5 rounded-3xl shadow-sm border border-slate-200">
            <div class="flex items-center gap-4 w-full md:w-auto">
                <a href="./index.html" class="bg-gray-100 hover:bg-gray-200 text-gray-600 px-4 py-3 rounded-2xl font-bold transition flex items-center gap-2 text-sm whitespace-nowrap">
                    <i class="fas fa-pencil-alt"></i> ì‘ì„±í•˜ê¸°
                </a>
                <h1 class="text-xl md:text-2xl font-bold text-slate-800 flex items-center gap-2">
                    ğŸ“‹ ì ‘ìˆ˜ í˜„í™©
                </h1>
            </div>
            
            <div class="flex items-center gap-2 bg-indigo-50 px-4 py-2 rounded-2xl border border-indigo-100 w-full md:w-auto">
                <i class="far fa-calendar-alt text-indigo-600"></i>
                <input type="date" id="filterDate" class="bg-transparent font-bold text-indigo-900 focus:outline-none cursor-pointer w-full md:w-auto p-1">
            </div>
        </header>

        <div id="loading" class="text-center py-20">
            <i class="fas fa-circle-notch fa-spin text-4xl text-indigo-500 mb-4"></i>
            <p class="text-slate-500">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</p>
        </div>

        <div id="noData" class="hidden flex flex-col items-center justify-center py-24 bg-white rounded-3xl border-2 border-dashed border-slate-300">
            <i class="far fa-folder-open text-5xl text-slate-300 mb-4"></i>
            <p class="text-slate-500 font-medium">ì•„ì§ ì ‘ìˆ˜ëœ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        </div>

        <div id="contentArea" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
    </div>

    <script>
        // âš ï¸ [ìˆ˜ì •í•„ìˆ˜] ì—¬ê¸°ë„ êµ¬ê¸€ ìŠ¤í¬ë¦½íŠ¸ URL ê¼­ ë„£ì–´ì£¼ì„¸ìš”!
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxAItLf7sBsBhX-VIcTWruv1ukt8XSR-qNMy_GesNUhPQQFvDkCoztFQqDVNSrXrYuu/exec'; 

        const today = new Date(); 
        const nextSun = new Date(today.setDate(today.getDate() + (7 - today.getDay()) % 7 || 7));
        document.getElementById('filterDate').value = nextSun.toISOString().split('T')[0];
        
        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        fetch(SCRIPT_URL)
        .then(res => res.json())
        .then(data => {
            const render = () => {
                const date = document.getElementById('filterDate').value;
                const container = document.getElementById('contentArea');
                const loading = document.getElementById('loading');
                const noData = document.getElementById('noData');
                
                loading.classList.add('hidden');
                container.innerHTML = '';
                
                // ë‚ ì§œ í•„í„°ë§ (êµ¬ê¸€ì‹œíŠ¸ ë‚ ì§œ ì• 10ìë¦¬ ë¹„êµ)
                const filtered = data.filter(i => i.date.substring(0, 10) === date);

                if(!filtered.length) {
                    noData.classList.remove('hidden');
                    container.classList.add('hidden');
                    return;
                }

                noData.classList.add('hidden');
                container.classList.remove('hidden');
                
                filtered.forEach(item => {
                    // ë””ìì¸ í…Œë§ˆ ì„¤ì •
                    let theme = { border: 'border-l-indigo-500', icon: 'ğŸ“', bg: 'bg-indigo-50', text: 'text-indigo-700' };
                    if(item.department.includes('ì„¤êµ')) theme = { border: 'border-l-blue-500', icon: 'ğŸ“–', bg: 'bg-blue-50', text: 'text-blue-700' };
                    else if(item.department.includes('ì°¬ì–‘')) theme = { border: 'border-l-emerald-500', icon: 'ğŸµ', bg: 'bg-emerald-50', text: 'text-emerald-700' };
                    else if(item.department.includes('í•™êµ')) theme = { border: 'border-l-pink-500', icon: 'ğŸ«', bg: 'bg-pink-50', text: 'text-pink-700' };
                    else if(item.department.includes('ê´‘ê³ ')) theme = { border: 'border-l-orange-500', icon: 'ğŸ“¢', bg: 'bg-orange-50', text: 'text-orange-700' };

                    // ë³µì‚¬ í…ìŠ¤íŠ¸ í¬ë§·íŒ…
                    let copyText = "";
                    if(item.department.includes('ì„¤êµ')) copyText = `[${item.department}]\nì œëª©: ${item.field2}\në³¸ë¬¸: ${item.field1}`;
                    else copyText = `${item.department}\n${item.field1 ? item.field1 + ' ' : ''}${item.longText}`.trim();

                    container.innerHTML += `
                        <div class="card-hover bg-white rounded-3xl shadow-sm border border-slate-100 overflow-hidden flex flex-col transition-all duration-300">
                            <div class="px-6 py-4 border-b border-slate-50 flex justify-between items-center ${theme.bg}">
                                <span class="font-bold text-lg flex items-center gap-2 ${theme.text}">${theme.icon} ${item.department}</span>
                                <span class="text-xs bg-white/80 px-2 py-1 rounded-lg text-slate-500 font-medium">${item.writer}</span>
                            </div>
                            
                            <div class="p-6 flex-grow space-y-3">
                                ${item.field1 ? `<div class="bg-slate-50 p-3 rounded-xl border border-slate-100"><span class="text-xs text-slate-400 block mb-1">ë¶„ë¥˜/ë³¸ë¬¸</span><p class="font-semibold text-slate-700">${item.field1}</p></div>` : ''}
                                ${item.field2 ? `<div class="bg-slate-50 p-3 rounded-xl border border-slate-100"><span class="text-xs text-slate-400 block mb-1">ì œëª©</span><p class="font-bold text-lg text-slate-800">${item.field2}</p></div>` : ''}
                                ${item.longText ? `<div class="text-sm text-slate-600 leading-relaxed whitespace-pre-wrap">${item.longText}</div>` : ''}
                            </div>

                            <div class="p-4 bg-slate-50/50 mt-auto">
                                <button onclick="navigator.clipboard.writeText(\`${copyText.replace(/`/g, '')}\`).then(()=>alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! âœ¨'))" 
                                    class="w-full py-3 bg-white border border-slate-200 hover:border-indigo-500 hover:text-indigo-600 text-slate-600 font-bold rounded-xl shadow-sm transition-all duration-200 flex items-center justify-center gap-2 group">
                                    <i class="far fa-copy group-hover:scale-110 transition-transform"></i> ë‚´ìš© ë³µì‚¬í•˜ê¸°
                                </button>
                            </div>
                        </div>`;
                });
            };
            render();
            document.getElementById('filterDate').addEventListener('change', render);
        });
    </script>
</body>
</html>
