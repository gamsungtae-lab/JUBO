<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì£¼ë³´ ì¢…í•© ìƒí™©íŒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>@import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css'); body { font-family: 'Pretendard', sans-serif; }</style>
</head>
<body class="bg-slate-100 p-6">
    <div class="max-w-5xl mx-auto">
        <header class="flex justify-between items-center mb-6 bg-white p-4 rounded-xl shadow">
            <h1 class="text-xl font-bold">ğŸ“‹ ì£¼ë³´ ì ‘ìˆ˜ í˜„í™©</h1>
            <input type="date" id="filterDate" class="p-2 border rounded font-bold text-slate-700">
        </header>
        <div id="content" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
    </div>
    <script>
        // âš ï¸ ì—¬ê¸°ì— ì•„ê¹Œ ë³µì‚¬í•œ êµ¬ê¸€ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxAItLf7sBsBhX-VIcTWruv1ukt8XSR-qNMy_GesNUhPQQFvDkCoztFQqDVNSrXrYuu/exec'; 

        const today = new Date(); const nextSun = new Date(today.setDate(today.getDate() + (7 - today.getDay()) % 7 || 7));
        document.getElementById('filterDate').value = nextSun.toISOString().split('T')[0];
        
        fetch(SCRIPT_URL).then(res => res.json()).then(data => {
            const render = () => {
                const date = document.getElementById('filterDate').value;
                const filtered = data.filter(i => i.date.startsWith(date));
                const div = document.getElementById('content'); div.innerHTML = '';
                
                if(!filtered.length) div.innerHTML = '<p class="col-span-3 text-center text-gray-400 py-10">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                
                filtered.forEach(item => {
                    // ë³µì‚¬ë  í…ìŠ¤íŠ¸ í˜•ì‹ ë§Œë“¤ê¸°
                    let copyText = "";
                    if (item.department.includes('ì„¤êµ')) {
                        copyText = `[${item.department}]\nì œëª©: ${item.field2}\në³¸ë¬¸: ${item.field1}`;
                    } else {
                        // ì°¬ì–‘ëŒ€, ê´‘ê³  ë“±ì€ ë‚´ìš© í•©ì¹˜ê¸°
                        copyText = `${item.department}\n${item.field1 ? item.field1 + ' ' : ''}${item.longText}`.trim();
                    }

                    div.innerHTML += `
                        <div class="bg-white p-5 rounded-xl shadow border-l-4 ${item.department.includes('ì„¤êµ')?'border-blue-500':item.department.includes('ì°¬ì–‘')?'border-green-500':'border-orange-500'}">
                            <div class="flex justify-between font-bold mb-2"><span>${item.department}</span><span class="text-xs text-gray-400 font-normal">${item.writer}</span></div>
                            <div class="text-sm text-gray-700 space-y-1 mb-4">
                                ${item.field1 ? `<p class="font-semibold text-indigo-600">ğŸ“Œ ${item.field1}</p>` : ''} 
                                ${item.field2 ? `<p class="font-bold text-lg">ğŸ“¢ ${item.field2}</p>` : ''}
                                ${item.longText ? `<p class="whitespace-pre-wrap bg-gray-50 p-2 rounded mt-2">${item.longText}</p>` : ''}
                            </div>
                            <button onclick="navigator.clipboard.writeText(\`${copyText.replace(/`/g, '')}\`).then(()=>alert('ë³µì‚¬ë¨!'))" class="w-full py-2 bg-gray-100 hover:bg-indigo-100 text-indigo-700 font-bold rounded text-sm">ë³µì‚¬í•˜ê¸°</button>
                        </div>`;
                });
            };
            render();
            document.getElementById('filterDate').addEventListener('change', render);
        });
    </script>
</body>
</html>